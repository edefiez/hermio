{% extends 'base_public.html.twig' %}

{% block title %}{{ card.content.name|default('card.public.title'|trans) }} - Hermio{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    {{ encore_entry_link_tags('public-card') }}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
{% endblock %}

{% block body %}
<div class="public-card-container">
    <div class="public-card">
        {# Logo (if branded) #}
        {% if branding and branding.logoFilename %}
            {% set logoPosition = branding.logoPosition|default('top-left') %}
            {% set logoSize = branding.logoSize|default('medium') %}
            <div class="brand-logo brand-logo-{{ logoPosition }} brand-logo-{{ logoSize }}">
                <img src="{{ asset('uploads/branding/logos/' ~ branding.logoFilename) }}?v={{ 'now'|date('U') }}" alt="Brand Logo">
            </div>
        {% endif %}

        {# Card Header Section #}
        <div class="card-header-section">
            <h1 class="card-name">{{ card.content.name|default('card.public.title'|trans) }}</h1>

            {% if card.content.title %}
                <p class="card-title">{{ card.content.title }}</p>
            {% endif %}

            {% if card.content.company %}
                <p class="card-company">{{ card.content.company }}</p>
            {% endif %}
        </div>

        {# Contact Actions (Call/Email) #}
        {% if card.content.phone or card.content.email %}
            <div class="contact-actions">
                {% if card.content.phone %}
                    <a href="tel:{{ card.content.phone }}" class="btn btn-action btn-call" aria-label="{{ 'card.action.call'|trans }} {{ card.content.phone }}">
                        <i class="bi bi-telephone-fill"></i>
                        <span>{{ 'card.action.call'|trans }}</span>
                    </a>
                {% endif %}
                {% if card.content.email %}
                    <a href="mailto:{{ card.content.email }}" class="btn btn-action btn-email" aria-label="{{ 'card.action.email'|trans }} {{ card.content.email }}">
                        <i class="bi bi-envelope-fill"></i>
                        <span>{{ 'card.action.email'|trans }}</span>
                    </a>
                {% endif %}
            </div>
        {% endif %}

        {# Download Button - Desktop (inline) #}
        <div class="text-center mb-4 d-none d-md-block">
            <a href="{{ path('public_card_download', {slug: card.slug}) }}" class="btn btn-download" aria-label="{{ 'card.download'|trans }}">
                <i class="bi bi-download"></i>
                <span>{{ 'card.download'|trans }}</span>
            </a>
        </div>

        {# Contact Info Section #}
        {% if card.content.email or card.content.phone or card.content.website %}
            <div class="contact-info">
                {% if card.content.email %}
                    <div class="contact-info-item">
                        <span class="contact-label">
                            <i class="bi bi-envelope contact-icon"></i>
                            {{ 'card.email'|trans }}
                        </span>
                        <span class="contact-value">
                            <a href="mailto:{{ card.content.email }}">{{ card.content.email }}</a>
                        </span>
                    </div>
                {% endif %}

                {% if card.content.phone %}
                    <div class="contact-info-item">
                        <span class="contact-label">
                            <i class="bi bi-telephone contact-icon"></i>
                            {{ 'card.phone'|trans }}
                        </span>
                        <span class="contact-value">
                            <a href="tel:{{ card.content.phone }}">{{ card.content.phone }}</a>
                        </span>
                    </div>
                {% endif %}

                {% if card.content.website %}
                    <div class="contact-info-item">
                        <span class="contact-label">
                            <i class="bi bi-globe contact-icon"></i>
                            {{ 'card.website'|trans }}
                        </span>
                        <span class="contact-value">
                            <a href="{{ card.content.website }}" target="_blank" rel="noopener">{{ card.content.website }}</a>
                        </span>
                    </div>
                {% endif %}
            </div>
        {% endif %}

        {# Bio Section #}
        {% if card.content.bio %}
            <div class="card-bio">
                <h2>{{ 'card.bio.title'|trans }}</h2>
                <p>{{ card.content.bio|nl2br }}</p>
            </div>
        {% endif %}

        {# Social Networks Section #}
        {% set hasSocial = (card.content.social.linkedin ?? false)
              or (card.content.social.instagram ?? false) or (card.content.social.tiktok ?? false)
              or (card.content.social.facebook ?? false) or (card.content.social.x ?? false)
              or (card.content.social.snapchat ?? false) or (card.content.social.bluebirds ?? false)
              or (card.content.social.planity ?? false) or (card.content.social.other ?? false)
        %}
        {% if hasSocial %}
            <div class="social-links">
                <h2>{{ 'card.social.title'|trans }}</h2>
                <div class="social-links-grid">
                    {# Social fields (all stored in content.social) #}
                    {% if card.content.social %}
                        {% if card.content.social.linkedin ?? false %}
                            <a href="{{ card.content.social.linkedin }}" target="_blank" rel="noopener"
                               class="social-link" data-platform="linkedin"
                               aria-label="{{ 'card.social.linkedin.aria'|trans }}">
                                <i class="bi bi-linkedin" aria-hidden="true"></i>
                                <span class="d-none d-sm-inline">LinkedIn</span>
                            </a>
                        {% endif %}
                        {% if card.content.social.instagram ?? false %}
                            <a href="{{ card.content.social.instagram }}" target="_blank" rel="noopener"
                               class="social-link" data-platform="instagram"
                               aria-label="{{ 'card.social.instagram.aria'|trans }}">
                                <i class="bi bi-instagram" aria-hidden="true"></i>
                                <span class="d-none d-sm-inline">Instagram</span>
                            </a>
                        {% endif %}
                        {% if card.content.social.tiktok ?? false %}
                            <a href="{{ card.content.social.tiktok }}" target="_blank" rel="noopener"
                               class="social-link" data-platform="tiktok"
                               aria-label="{{ 'card.social.tiktok.aria'|trans }}">
                                <i class="bi bi-tiktok" aria-hidden="true"></i>
                                <span class="d-none d-sm-inline">TikTok</span>
                            </a>
                        {% endif %}
                        {% if card.content.social.facebook ?? false %}
                            <a href="{{ card.content.social.facebook }}" target="_blank" rel="noopener"
                               class="social-link" data-platform="facebook"
                               aria-label="{{ 'card.social.facebook.aria'|trans }}">
                                <i class="bi bi-facebook" aria-hidden="true"></i>
                                <span class="d-none d-sm-inline">Facebook</span>
                            </a>
                        {% endif %}
                        {% if card.content.social.x ?? false %}
                            <a href="{{ card.content.social.x }}" target="_blank" rel="noopener"
                               class="social-link" data-platform="x"
                               aria-label="{{ 'card.social.x.aria'|trans }}">
                                <i class="bi bi-twitter-x" aria-hidden="true"></i>
                                <span class="d-none d-sm-inline">X</span>
                            </a>
                        {% endif %}
                        {% if card.content.social.snapchat ?? false %}
                            <a href="{{ card.content.social.snapchat }}" target="_blank" rel="noopener"
                               class="social-link" data-platform="snapchat"
                               aria-label="{{ 'card.social.snapchat.aria'|trans }}">
                                <i class="bi bi-snapchat" aria-hidden="true"></i>
                                <span class="d-none d-sm-inline">Snapchat</span>
                            </a>
                        {% endif %}
                        {% if card.content.social.planity ?? false %}
                            <a href="{{ card.content.social.planity }}" target="_blank" rel="noopener"
                               class="social-link" data-platform="planity"
                               aria-label="{{ 'card.social.planity.aria'|trans }}">
                                <i class="bi bi-calendar-check" aria-hidden="true"></i>
                                <span class="d-none d-sm-inline">Planity</span>
                            </a>
                        {% endif %}
                        {% if card.content.social.bluebirds ?? false %}
                            <a href="{{ card.content.social.bluebirds }}" target="_blank" rel="noopener"
                               class="social-link" data-platform="bluebirds"
                               aria-label="{{ 'card.social.bluebirds.aria'|trans }}">
                                <i class="bi bi-chat-dots" aria-hidden="true"></i>
                                <span class="d-none d-sm-inline">Bluebirds</span>
                            </a>
                        {% endif %}
                        {% if card.content.social.other ?? false %}
                            <a href="{{ card.content.social.other }}" target="_blank" rel="noopener"
                               class="social-link" data-platform="other"
                               aria-label="{{ 'card.social.other.aria'|trans }}">
                                <i class="bi bi-link-45deg" aria-hidden="true"></i>
                                <span class="d-none d-sm-inline">{{ 'card.social.other'|trans }}</span>
                            </a>
                        {% endif %}
                    {% endif %}
                </div>
            </div>
        {% endif %}

        {# Footer #}
        <div class="text-center mt-4" style="color: #888; font-size: 0.875rem;">
            <p>
                <a href="{{ path('app_home') }}"
                   style="color: #888; text-decoration: none; transition: color 0.3s;"
                   onmouseover="this.style.color='#333'"
                   onmouseout="this.style.color='#888'"
                   target="_blank"
                   rel="noopener">
                    {{ 'card.powered_by'|trans }}
                </a>
            </p>
        </div>
    </div>

    {# Fixed Download Button - Mobile Only #}
    <a href="{{ path('public_card_download', {slug: card.slug}) }}"
       class="btn btn-download btn-download-mobile d-md-none"
       aria-label="{{ 'card.download'|trans }}">
        <i class="bi bi-download"></i>
        <span>{{ 'card.download'|trans }}</span>
    </a>
</div>
{% endblock %}


