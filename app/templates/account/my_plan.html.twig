{% extends 'base_admin.html.twig' %}

{% block title %}{{ 'account.my_plan.title'|trans }} - Hermio{% endblock %}

{% block page_title %}{{ 'account.my_plan.title'|trans }}{% endblock %}

{% block admin_content %}
<div class="profile-container">
    <div class="profile-card">
        <h1>{{ 'account.my_plan.title'|trans }}</h1>
        
        <div class="profile-info">
            <dl>
                <dt>{{ 'account.plan.type'|trans }}</dt>
                <dd>
                    <strong>{{ planType.getDisplayName() }}</strong>
                    <span class="badge badge-{{ planType == constant('App\\Enum\\PlanType::FREE') ? 'warning' : (planType == constant('App\\Enum\\PlanType::PRO') ? 'success' : 'primary') }}">
                        {{ planType.value }}
                    </span>
                </dd>
                
                <dt>{{ 'account.quota.limit'|trans }}</dt>
                <dd>
                    {% if isUnlimited %}
                        <strong>{{ 'account.quota.unlimited'|trans }}</strong>
                    {% else %}
                        {{ quotaLimit }} {{ 'account.quota.cards'|trans }}
                    {% endif %}
                </dd>
                
                <dt>{{ 'account.quota.usage'|trans }}</dt>
                <dd>
                    <strong>{{ currentUsage }}</strong> {{ 'account.quota.cards'|trans }}
                    {% if not isUnlimited and quotaLimit %}
                        {% set percentage = (currentUsage / quotaLimit * 100)|round %}
                        <div style="margin-top: 10px;">
                            <div style="background-color: #e9ecef; border-radius: 4px; height: 20px; overflow: hidden;">
                                <div style="background-color: {{ percentage >= 100 ? '#dc3545' : (percentage >= 80 ? '#ffc107' : '#28a745') }}; height: 100%; width: {{ percentage }}%; transition: width 0.3s;"></div>
                            </div>
                            <small style="color: #666;">{{ percentage }}% {{ 'account.quota.used'|trans }}</small>
                        </div>
                    {% endif %}
                </dd>
                
                <dt>{{ 'account.plan.activated'|trans }}</dt>
                <dd>{{ account.createdAt|date('Y-m-d H:i:s') }}</dd>
                
                {% if account.updatedAt %}
                <dt>{{ 'account.plan.last_modified'|trans }}</dt>
                <dd>{{ account.updatedAt|date('Y-m-d H:i:s') }}</dd>
                {% endif %}
            </dl>
        </div>
        
        {% if planType == constant('App\\Enum\\PlanType::FREE') %}
        <div style="margin-top: 30px;">
            <h3>{{ 'subscription.upgrade.title'|trans }}</h3>
            <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                <form method="post" action="{{ path('app_subscription_checkout_create') }}" style="display: inline;">
                    <input type="hidden" name="planType" value="pro">
                    <button type="submit" class="btn btn-success">
                        {{ 'subscription.upgrade.pro'|trans }}
                    </button>
                </form>
                <form method="post" action="{{ path('app_subscription_checkout_create') }}" style="display: inline;">
                    <input type="hidden" name="planType" value="enterprise">
                    <button type="submit" class="btn btn-primary">
                        {{ 'subscription.upgrade.enterprise'|trans }}
                    </button>
                </form>
            </div>
        </div>
        {% elseif planType == constant('App\\Enum\\PlanType::PRO') %}
        <div style="margin-top: 30px;">
            <h3>{{ 'subscription.upgrade.title'|trans }}</h3>
            <form method="post" action="{{ path('app_subscription_checkout_create') }}" style="display: inline;">
                <input type="hidden" name="planType" value="enterprise">
                <button type="submit" class="btn btn-primary">
                    {{ 'subscription.upgrade.enterprise'|trans }}
                </button>
            </form>
        </div>
        {% endif %}
        
        <div style="margin-top: 30px;">
            <a href="{{ path('app_account_index') }}" class="btn btn-secondary">{{ 'account.back_to_account'|trans }}</a>
        </div>
    </div>
</div>
{% endblock %}

